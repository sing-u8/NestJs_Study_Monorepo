---
description:
globs:
alwaysApply: true
---
use context7
use pnpm package manager

general implementation order: Domain â†’ Application â†’ Infrastructure â†’ Presentation

- actual hybrid implementation approach
Phase 1 - ê¸°ë°˜ ì„¤ì •:
1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (DB, JWT, Config)
2. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
3. ê¸°ë³¸ ëª¨ë“ˆ êµ¬ì¡°
4. TypeORM ì—”í‹°í‹° (ìŠ¤í‚¤ë§ˆ ì •ì˜)

Phase 2 - ë„ë©”ì¸ í•µì‹¬:
5. ë„ë©”ì¸ ì—”í‹°í‹° & ê°’ ê°ì²´ ì •ì˜
6. ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤
7. ë„ë©”ì¸ ì˜ˆì™¸

Phase 3 - ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§:
8. ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤
9. DTO ì •ì˜

Phase 4 - ì¸í”„ë¼ êµ¬í˜„:
10. ë¦¬í¬ì§€í† ë¦¬ êµ¬í˜„ì²´
11. ì™¸ë¶€ ì„œë¹„ìŠ¤ (JWT, ì†Œì…œ ë¡œê·¸ì¸)

Phase 5 - API ê³„ì¸µ:
12. ì»¨íŠ¸ë¡¤ëŸ¬
13. ê°€ë“œ & ë°ì½”ë ˆì´í„°
14. ì˜ˆì™¸ í•„í„°

- ë„ë©”ì¸ ì„¤ê³„
-- ë„ë©”ì¸ ì—”í‹°í‹°ì™€ ê°’ ê°ì²´ ì •ì˜
--  ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ êµ¬í˜„

- ê¸°ëŠ¥ë³„ ìˆ˜ì§ì  êµ¬í˜„
-- íšŒì›ê°€ì… API â†’ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ â†’ ë¦¬í¬ì§€í† ë¦¬ â†’ í…ŒìŠ¤íŠ¸


- auth-VC folder structure
apps/auth-vC/src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ app.module.ts
â”‚   â””â”€â”€ app.controller.ts
â”œâ”€â”€ auth/                              # Auth ë„ë©”ì¸ ë£¨íŠ¸
â”‚   â”œâ”€â”€ application/                   # ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ
â”‚   â”‚   â”œâ”€â”€ service/                  # ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ user.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ jwt.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ password.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ social-auth.service.ts
â”‚   â”‚   â”œâ”€â”€ dto/                       # ì• í”Œë¦¬ì¼€ì´ì…˜ DTO
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.dto.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ user.dto.ts
â”‚   â”‚   â”‚   â””â”€â”€ social-auth.dto.ts
â”‚   â”‚   â””â”€â”€ event/                    # ë„ë©”ì¸ ì´ë²¤íŠ¸
â”‚   â”‚       â”œâ”€â”€ handler/              # ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
â”‚   â”‚       â”‚   â”œâ”€â”€ user-registered.handler.ts
â”‚   â”‚       â”‚   â”œâ”€â”€ user-logged-in.handler.ts
â”‚   â”‚       â”‚   â””â”€â”€ user-deleted.handler.ts
â”‚   â”‚       â””â”€â”€ event/                # ì´ë²¤íŠ¸ í´ë˜ìŠ¤
â”‚   â”‚           â”œâ”€â”€ user-registered.event.ts
â”‚   â”‚           â”œâ”€â”€ user-logged-in.event.ts
â”‚   â”‚           â””â”€â”€ user-deleted.event.ts
â”‚   â”œâ”€â”€ domain/                        # ë„ë©”ì¸ ê³„ì¸µ
â”‚   â”‚   â”œâ”€â”€ entity/                  # ë„ë©”ì¸ ì—”í‹°í‹°
â”‚   â”‚   â”‚   â”œâ”€â”€ user.entity.ts
â”‚   â”‚   â”‚   â””â”€â”€ refresh-token.entity.ts
â”‚   â”‚   â”œâ”€â”€ vo/             # ê°’ ê°ì²´
â”‚   â”‚   â”‚   â”œâ”€â”€ email.vo.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ password.vo.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ provider.vo.ts
â”‚   â”‚   â”‚   â””â”€â”€ user-id.vo.ts
â”‚   â”‚   â”œâ”€â”€ repository/              # ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ user.repository.interface.ts
â”‚   â”‚   â”‚   â””â”€â”€ refresh-token.repository.interface.ts
â”‚   â”‚   â”œâ”€â”€ service/                  # ë„ë©”ì¸ ì„œë¹„ìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ user.domain.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ password.domain.service.ts
â”‚   â”‚   â””â”€â”€ exception/                # ë„ë©”ì¸ ì˜ˆì™¸
â”‚   â”‚       â”œâ”€â”€ user-already-exists.exception.ts
â”‚   â”‚       â”œâ”€â”€ invalid-credentials.exception.ts
â”‚   â”‚       â”œâ”€â”€ user-not-found.exception.ts
â”‚   â”‚       â””â”€â”€ invalid-refresh-token.exception.ts
â”‚   â”œâ”€â”€ infrastructure/                # ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ê³„ì¸µ
â”‚   â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”‚   â”œâ”€â”€ entity/              # TypeORM ì—”í‹°í‹°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.typeorm.entity.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ refresh-token.typeorm.entity.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ repository/          # ë¦¬í¬ì§€í† ë¦¬ êµ¬í˜„ì²´
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.typeorm.repository.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ refresh-token.typeorm.repository.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ migration/            # ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ 1234567890-create-users-table.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ 1234567891-create-refresh-tokens-table.ts
â”‚   â”‚   â”‚   â””â”€â”€ seeds/                 # ì‹œë“œ ë°ì´í„°
â”‚   â”‚   â”‚       â””â”€â”€ user.seed.ts
â”‚   â”‚   â”œâ”€â”€ external-service/         # ì™¸ë¶€ ì„œë¹„ìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ google-auth.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ apple-auth.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ email.service.ts
â”‚   â”‚   â”œâ”€â”€ guard/                    # ê°€ë“œ
â”‚   â”‚   â”‚   â”œâ”€â”€ jwt-auth.guard.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ refresh-token.guard.ts
â”‚   â”‚   â”‚   â””â”€â”€ optional-auth.guard.ts
â”‚   â”‚   â”œâ”€â”€ strategy/                # Passport ì „ëµ
â”‚   â”‚   â”‚   â”œâ”€â”€ jwt.strategy.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ refresh-token.strategy.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ google.strategy.ts
â”‚   â”‚   â”‚   â””â”€â”€ apple.strategy.ts
â”‚   â”‚   â””â”€â”€ config/                    # ì„¤ì •
â”‚   â”‚       â”œâ”€â”€ database.config.ts
â”‚   â”‚       â”œâ”€â”€ jwt.config.ts
â”‚   â”‚       â””â”€â”€ social-auth.config.ts
â”‚   â””â”€â”€ presentation/                  # í”„ë ˆì  í…Œì´ì…˜ ê³„ì¸µ
â”‚       â”œâ”€â”€ controller/
â”‚       â”‚   â”œâ”€â”€ auth.controller.ts
â”‚       â”‚   â”œâ”€â”€ user.controller.ts
â”‚       â”‚   â””â”€â”€ social-auth.controller.ts
â”‚       â”œâ”€â”€ dto/                       # ìš”ì²­/ì‘ë‹µ DTO
â”‚       â”‚   â”œâ”€â”€ requests/
â”‚       â”‚   â”‚   â”œâ”€â”€ signup.request.dto.ts
â”‚       â”‚   â”‚   â”œâ”€â”€ login.request.dto.ts
â”‚       â”‚   â”‚   â”œâ”€â”€ refresh-token.request.dto.ts
â”‚       â”‚   â”‚   â””â”€â”€ social-login.request.dto.ts
â”‚       â”‚   â””â”€â”€ responses/
â”‚       â”‚       â”œâ”€â”€ auth.response.dto.ts
â”‚       â”‚       â”œâ”€â”€ user.response.dto.ts
â”‚       â”‚       â””â”€â”€ token.response.dto.ts
â”‚       â”œâ”€â”€ decorator/                # ì»¤ìŠ¤í…€ ë°ì½”ë ˆì´í„°
â”‚       â”‚   â”œâ”€â”€ current-user.decorator.ts
â”‚       â”‚   â”œâ”€â”€ public.decorator.ts
â”‚       â”‚   â””â”€â”€ roles.decorator.ts
â”‚       â”œâ”€â”€ filter/                   # ì˜ˆì™¸ í•„í„°
â”‚       â”‚   â”œâ”€â”€ auth-exception.filter.ts
â”‚       â”‚   â””â”€â”€ domain-exception.filter.ts
â”‚       â””â”€â”€ interceptor/              # ì¸í„°ì…‰í„°
â”‚           â”œâ”€â”€ response.interceptor.ts
â”‚           â””â”€â”€ logging.interceptor.ts
â”œâ”€â”€ shared/                            # ê³µí†µ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ interface/
â”‚   â”‚   â”œâ”€â”€ repository.interface.ts
â”‚   â”‚   â””â”€â”€ service.interface.ts
â”‚   â”œâ”€â”€ type/
â”‚   â”‚   â”œâ”€â”€ auth.types.ts
â”‚   â”‚   â””â”€â”€ common.types.ts
â”‚   â”œâ”€â”€ constant/
â”‚   â”‚   â”œâ”€â”€ auth.constants.ts
â”‚   â”‚   â””â”€â”€ app.constants.ts
â”‚   â”œâ”€â”€ util/
â”‚   â”‚   â”œâ”€â”€ hash.util.ts
â”‚   â”‚   â”œâ”€â”€ token.util.ts
â”‚   â”‚   â””â”€â”€ validation.util.ts
â”‚   â””â”€â”€ enum/
â”‚       â”œâ”€â”€ provider.enum.ts
â”‚       â””â”€â”€ user-status.enum.ts
â”œâ”€â”€ config/                            # ì „ì—­ ì„¤ì •
â”‚   â”œâ”€â”€ app.config.ts
â”‚   â”œâ”€â”€ database.config.ts
â”‚   â””â”€â”€ env.validation.ts
â””â”€â”€ main.ts



# êµ¬í˜„ ìƒí™©
# ğŸš€ NestJS Clean Architecture Auth System - Step 1 ì™„ë£Œ í˜„í™©

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

- **ëª©í‘œ**: NestJS + í´ë¦° ì•„í‚¤í…ì²˜ë¥¼ ì‚¬ìš©í•œ ì¸ì¦ ì‹œìŠ¤í…œ êµ¬í˜„
- **ê¸°ëŠ¥**: íšŒì›ê°€ì…, ë¡œê·¸ì¸(ì¼ë°˜/ì†Œì…œ), ë¡œê·¸ì•„ì›ƒ, íšŒì›íƒˆí‡´
- **ë°ì´í„°ë² ì´ìŠ¤**: PostgreSQL + TypeORM
- **ì•„í‚¤í…ì²˜**: CQRS ì—†ëŠ” í´ë¦° ì•„í‚¤í…ì²˜ (Domain â†’ Application â†’ Infrastructure â†’ Presentation)

## âœ… Phase 1: ê¸°ë°˜ ì„¤ì • ì™„ë£Œ ë‚´ì—­

### 1. í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬ ì‹œìŠ¤í…œ

```typescript
// apps/auth-vC/src/config/env.validation.ts
- Joi ê¸°ë°˜ í™˜ê²½ ë³€ìˆ˜ ê²€ì¦ ìŠ¤í‚¤ë§ˆ
- TypeScript íƒ€ì… ì •ì˜ (EnvironmentVariables)
- í•„ìˆ˜/ì„ íƒ í™˜ê²½ ë³€ìˆ˜ êµ¬ë¶„
- ê°œë°œ/í”„ë¡œë•ì…˜ í™˜ê²½ êµ¬ë¶„
```

**í¬í•¨ëœ í™˜ê²½ ë³€ìˆ˜:**

- DATABASE\_\* (PostgreSQL ì—°ê²° ì •ë³´)
- JWT_SECRET, REFRESH_TOKEN_SECRET (í† í° ì‹œí¬ë¦¿)
- GOOGLE*\*, APPLE*\* (ì†Œì…œ ë¡œê·¸ì¸ ì„¤ì •)
- PORT, NODE_ENV (ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì •)

### 2. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •

```typescript
// apps/auth-vC/src/config/database.config.ts
- TypeORM ì„¤ì • íŒ©í† ë¦¬ (registerAs ì‚¬ìš©)
- PostgreSQL ì—°ê²° ì„¤ì •
- ê°œë°œ/í…ŒìŠ¤íŠ¸ í™˜ê²½ë³„ ì„¤ì • ë¶„ë¦¬
- ì—°ê²° í’€, SSL, ë¡œê¹… ì„¤ì •
- ì—”í‹°í‹° ìë™ ë¡œë”© ê²½ë¡œ ì„¤ì •
```

### 3. JWT í† í° ì‹œìŠ¤í…œ

```typescript
// apps/auth-vC/src/config/jwt.config.ts
- Access Token / Refresh Token ë¶„ë¦¬ ì„¤ì •
- í† í° í˜ì´ë¡œë“œ íƒ€ì… ì •ì˜ (JwtPayload, RefreshTokenPayload)
- NestJS JWT ëª¨ë“ˆ ì„¤ì •
- ë°œí–‰ì(issuer), ëŒ€ìƒ(audience) ì„¤ì •
```

### 4. TypeORM ì—”í‹°í‹° (ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ê³„ì¸µ)

```typescript
// apps/auth-vC/src/auth/infrastructure/database/entity/

// user.typeorm.entity.ts
- ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´ (id, email, password_hash)
- ì†Œì…œ ë¡œê·¸ì¸ ì§€ì› (provider, provider_id)
- ê³„ì • ìƒíƒœ ê´€ë¦¬ (is_active, is_email_verified)
- í™œë™ ì¶”ì  (last_login_at, created_at, updated_at)
- ì¸ë±ìŠ¤ ìµœì í™” (ì´ë©”ì¼, ì†Œì…œë¡œê·¸ì¸ ì¡°íšŒ)

// refresh-token.typeorm.entity.ts
- ë¦¬í”„ë ˆì‹œ í† í° ê´€ë¦¬ (token, expires_at)
- ì‚¬ìš©ìì™€ 1:N ê´€ê³„ (CASCADE ì‚­ì œ)
- ë³´ì•ˆ ì¶”ì  (device_info, ip_address)
- í† í° ìƒíƒœ ê´€ë¦¬ (is_active, last_used_at)
- ë‹¤ì¤‘ ë””ë°”ì´ìŠ¤ ë¡œê·¸ì¸ ì§€ì›
```

### 5. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜

```typescript
// apps/auth-vC/src/auth/infrastructure/database/migration/

// 1234567890-create-users-table.ts
- users í…Œì´ë¸” ìƒì„±
- ì¸ë±ìŠ¤ ì„¤ì • (ì´ë©”ì¼, ì†Œì…œë¡œê·¸ì¸, í™œì„±ìƒíƒœ, ìƒì„±ì¼)
- ì œì•½ì¡°ê±´ ì„¤ì •

// 1234567891-create-refresh-tokens-table.ts
- refresh_tokens í…Œì´ë¸” ìƒì„±
- ì™¸ë˜í‚¤ ì œì•½ì¡°ê±´ (users.id ì°¸ì¡°, CASCADE ì‚­ì œ)
- ë³µí•© ì¸ë±ìŠ¤ (ì‚¬ìš©ìë³„ í™œì„± í† í° ì¡°íšŒ ìµœì í™”)
- í† í° ë§Œë£Œ ì •ë¦¬ë¥¼ ìœ„í•œ ì¸ë±ìŠ¤
```

### 6. ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì •

```typescript
// apps/auth-vC/src/app/app.module.ts
- ConfigModule ì „ì—­ ì„¤ì • (Joi ê²€ì¦)
- TypeORM ëª¨ë“ˆ ì„¤ì • (ë¹„ë™ê¸° ì„¤ì •)
- JwtModule ì „ì—­ ì„¤ì •
- EventEmitterModule ì¤€ë¹„ (ì£¼ì„ ì²˜ë¦¬)

// apps/auth-vC/src/main.ts
- ValidationPipe ì „ì—­ ì„¤ì • (DTO ê²€ì¦)
- CORS ì„¤ì • (ê°œë°œ/í”„ë¡œë•ì…˜ êµ¬ë¶„)
- ê¸€ë¡œë²Œ í”„ë¦¬í”½ìŠ¤ (/api)
- ìš°ì•„í•œ ì¢…ë£Œ ì„¤ì •
```

## ğŸ“ í˜„ì¬ í´ë” êµ¬ì¡°

```
apps/auth-vC/src/
â”œâ”€â”€ config/                     # ì „ì—­ ì„¤ì •
â”‚   â”œâ”€â”€ env.validation.ts       âœ… í™˜ê²½ë³€ìˆ˜ ê²€ì¦
â”‚   â”œâ”€â”€ database.config.ts      âœ… DB ì„¤ì •
â”‚   â””â”€â”€ jwt.config.ts          âœ… JWT ì„¤ì •
â”œâ”€â”€ auth/
â”‚   â””â”€â”€ infrastructure/
â”‚       â””â”€â”€ database/
â”‚           â”œâ”€â”€ entity/       # TypeORM ì—”í‹°í‹°
â”‚           â”‚   â”œâ”€â”€ user.typeorm.entity.ts          âœ…
â”‚           â”‚   â””â”€â”€ refresh-token.typeorm.entity.ts âœ…
â”‚           â””â”€â”€ migration/     # DB ìŠ¤í‚¤ë§ˆ ë²„ì „ ê´€ë¦¬
â”‚               â”œâ”€â”€ 1234567890-create-users-table.ts        âœ…
â”‚               â””â”€â”€ 1234567891-create-refresh-tokens-table.ts âœ…
â”œâ”€â”€ app/
â”‚   â””â”€â”€ app.module.ts          âœ… ë£¨íŠ¸ ëª¨ë“ˆ (ì—…ë°ì´íŠ¸ë¨)
â””â”€â”€ main.ts                    âœ… ì• í”Œë¦¬ì¼€ì´ì…˜ ë¶€íŠ¸ìŠ¤íŠ¸ë©
```

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

```sql
-- Users í…Œì´ë¸”
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email VARCHAR(255) UNIQUE NOT NULL,
  password_hash VARCHAR(255),                    -- ì†Œì…œ ë¡œê·¸ì¸ì‹œ NULL
  provider VARCHAR(50) DEFAULT 'local',          -- 'local', 'google', 'apple'
  provider_id VARCHAR(255),                      -- ì†Œì…œ ë¡œê·¸ì¸ ID
  is_active BOOLEAN DEFAULT true,
  is_email_verified BOOLEAN DEFAULT false,
  last_login_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Refresh Tokens í…Œì´ë¸”
CREATE TABLE refresh_tokens (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  token VARCHAR(255) UNIQUE NOT NULL,
  expires_at TIMESTAMP NOT NULL,
  device_info VARCHAR(255),                      -- ë””ë°”ì´ìŠ¤ ì¶”ì 
  ip_address VARCHAR(45),                        -- IPv6 ì§€ì›
  is_active BOOLEAN DEFAULT true,
  last_used_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## ğŸ”§ í•„ìš”í•œ í™˜ê²½ ë³€ìˆ˜ (.env)

```env
# ë°ì´í„°ë² ì´ìŠ¤
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_USERNAME=postgres
DATABASE_PASSWORD=password
DATABASE_NAME=auth_db

# JWT (32ì ì´ìƒ ê¶Œì¥)
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-32chars
JWT_EXPIRES_IN=1h
REFRESH_TOKEN_SECRET=your-super-secret-refresh-token-key-change-this-in-production-32chars
REFRESH_TOKEN_EXPIRES_IN=7d

# ì†Œì…œ ë¡œê·¸ì¸ (ì„ íƒì‚¬í•­)
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_CALLBACK_URL=http://localhost:3000/api/auth/google/callback

# ì• í”Œë¦¬ì¼€ì´ì…˜
PORT=3000
NODE_ENV=development
```

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„ (Step 2: ë„ë©”ì¸ ê³„ì¸µ)

êµ¬í˜„ ì˜ˆì •:

1. **ë„ë©”ì¸ ì—”í‹°í‹° & ê°’ ê°ì²´**

   - `src/auth/domain/entity/user.entity.ts`
   - `src/auth/domain/vo/email.vo.ts`
   - `src/auth/domain/vo/password.vo.ts`
   - `src/auth/domain/vo/provider.vo.ts`

2. **ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤**

   - `src/auth/domain/repository/user.repository.interface.ts`
   - `src/auth/domain/repository/refresh-token.repository.interface.ts`

3. **ë„ë©”ì¸ ì˜ˆì™¸**
   - `src/auth/domain/exception/user-already-exists.exception.ts`
   - `src/auth/domain/exception/invalid-credentials.exception.ts`
   - `src/auth/domain/exception/user-not-found.exception.ts`

## ğŸ” í•µì‹¬ ì„¤ê³„ ì›ì¹™

1. **í´ë¦° ì•„í‚¤í…ì²˜**: ì˜ì¡´ì„± ì—­ì „, ê³„ì¸µ ë¶„ë¦¬
2. **íƒ€ì… ì•ˆì „ì„±**: TypeScript + Joi ê²€ì¦
3. **ë³´ì•ˆ**: JWT ë¶„ë¦¬, í™˜ê²½ë³€ìˆ˜ ê²€ì¦, í† í° ì¶”ì 
4. **í™•ì¥ì„±**: ì†Œì…œ ë¡œê·¸ì¸ ì§€ì›, ë‹¤ì¤‘ ë””ë°”ì´ìŠ¤
5. **ìœ ì§€ë³´ìˆ˜**: ë§ˆì´ê·¸ë ˆì´ì…˜, ì„¤ì • ë¶„ë¦¬, ë¬¸ì„œí™”



# ğŸ¯ NestJS Clean Architecture Auth System - Step 2 ì™„ë£Œ í˜„í™©

## ğŸ“‹ Step 2: ë„ë©”ì¸ ê³„ì¸µ êµ¬í˜„ ê°œìš”

- **ëª©í‘œ**: ë„ë©”ì¸ ì—”í‹°í‹°, ê°’ ê°ì²´, ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤, ë„ë©”ì¸ ì˜ˆì™¸ êµ¬í˜„
- **ì›ì¹™**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ ì¤‘ì‹¬, ì™¸ë¶€ ì˜ì¡´ì„± ì—†ëŠ” ìˆœìˆ˜í•œ ë„ë©”ì¸ ê·œì¹™
- **êµ¬ì¡°**: Entity â†’ Value Object â†’ Repository Interface â†’ Domain Service â†’ Exception

## âœ… Step 2: ë„ë©”ì¸ ê³„ì¸µ ì™„ë£Œ ë‚´ì—­

### 1. ê³µí†µ íƒ€ì… ë° ì—´ê±°í˜• (shared í´ë”)

```typescript
// apps/auth-vC/src/shared/enum/
- provider.enum.ts          âœ… ì¸ì¦ ì œê³µì ì—´ê±°í˜• (LOCAL, GOOGLE, APPLE)
- user-status.enum.ts       âœ… ì‚¬ìš©ì ìƒíƒœ ì—´ê±°í˜• (ACTIVE, INACTIVE, etc.)

// apps/auth-vC/src/shared/type/
- auth.types.ts             âœ… ì¸ì¦ ê´€ë ¨ íƒ€ì… ì •ì˜
- common.types.ts           âœ… ê³µí†µ ì¸í„°í˜ì´ìŠ¤ ë° íƒ€ì…
```

**ì£¼ìš” íŠ¹ì§•:**

- Provider ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ë¡œ ì œê³µì ê²€ì¦ ê¸°ëŠ¥
- UserStatus ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ë¡œ ìƒíƒœ ê´€ë¦¬ ê¸°ëŠ¥
- ë„ë©”ì¸ ì—”í‹°í‹°/ê°’ ê°ì²´ ê¸°ë³¸ ì¸í„°í˜ì´ìŠ¤ ì •ì˜
- í˜ì´ì§€ë„¤ì´ì…˜, ê²€ìƒ‰ ì˜µì…˜ íƒ€ì… ì •ì˜

### 2. ê°’ ê°ì²´ (Value Objects)

```typescript
// apps/auth-vC/src/auth/domain/vo/

// email.vo.ts                âœ… ì´ë©”ì¼ ê°’ ê°ì²´
- RFC 5321 í‘œì¤€ ì¤€ìˆ˜ (ìµœëŒ€ 254ì)
- ì´ë©”ì¼ í˜•ì‹ ê²€ì¦ (ì •ê·œì‹)
- ëŒ€ì†Œë¬¸ì ì •ê·œí™” ë° ê³µë°± ì œê±°
- ë„ë©”ì¸/ë¡œì»¬ ë¶€ë¶„ ì¶”ì¶œ ê¸°ëŠ¥

// password.vo.ts             âœ… ë¹„ë°€ë²ˆí˜¸ ê°’ ê°ì²´
- ë³µì¡ì„± ìš”êµ¬ì‚¬í•­ ê²€ì¦ (ëŒ€ì†Œë¬¸ì, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ì)
- ìµœì†Œ/ìµœëŒ€ ê¸¸ì´ ì œí•œ (8-128ì)
- ì—°ì†ëœ ë™ì¼ ë¬¸ì ë°©ì§€
- ë¹„ë°€ë²ˆí˜¸ ê°•ë„ ê³„ì‚° (1-5ì )

// provider.vo.ts             âœ… ì¸ì¦ ì œê³µì ê°’ ê°ì²´
- ì§€ì›ë˜ëŠ” ì œê³µìë§Œ í—ˆìš©
- ë¡œì»¬/ì†Œì…œ ì œê³µì êµ¬ë¶„ ê¸°ëŠ¥
- íŒ©í† ë¦¬ ë©”ì„œë“œ ì œê³µ

// user-id.vo.ts              âœ… ì‚¬ìš©ì ID ê°’ ê°ì²´
- UUID í˜•ì‹ ê²€ì¦
- ìƒˆ ID ìƒì„± ê¸°ëŠ¥
- ë¶ˆë³€ì„± ë³´ì¥
```

### 3. ë„ë©”ì¸ ì˜ˆì™¸ (Domain Exceptions)

```typescript
// apps/auth-vC/src/auth/domain/exception/

// domain.exception.ts              âœ… ë„ë©”ì¸ ì˜ˆì™¸ ê¸°ë³¸ í´ë˜ìŠ¤
- ì¶”ìƒ í´ë˜ìŠ¤ë¡œ ê³µí†µ ì˜ˆì™¸ êµ¬ì¡° ì •ì˜
- ì—ëŸ¬ ì½”ë“œ, HTTP ìƒíƒœ ì½”ë“œ í¬í•¨
- JSON ì§ë ¬í™” ì§€ì›

// user-already-exists.exception.ts âœ… ì‚¬ìš©ì ì¤‘ë³µ ì˜ˆì™¸
- 409 ìƒíƒœ ì½”ë“œ
- ì´ë©”ì¼ ì •ë³´ í¬í•¨

// user-not-found.exception.ts      âœ… ì‚¬ìš©ì ë¯¸ë°œê²¬ ì˜ˆì™¸
- 404 ìƒíƒœ ì½”ë“œ
- ID/ì´ë©”ì¼ êµ¬ë¶„ ì§€ì›

// invalid-credentials.exception.ts âœ… ì˜ëª»ëœ ì¸ì¦ ì •ë³´ ì˜ˆì™¸
- 401 ìƒíƒœ ì½”ë“œ
- ë¡œê·¸ì¸ ì‹¤íŒ¨ ì²˜ë¦¬

// invalid-refresh-token.exception.ts âœ… ìœ íš¨í•˜ì§€ ì•Šì€ í† í° ì˜ˆì™¸
- 401 ìƒíƒœ ì½”ë“œ
- í† í° ì‹¤íŒ¨ ì´ìœ  í¬í•¨
```

### 4. ë„ë©”ì¸ ì—”í‹°í‹° (Domain Entities)

```typescript
// apps/auth-vC/src/auth/domain/entity/

// user.entity.ts               âœ… ì‚¬ìš©ì ë„ë©”ì¸ ì—”í‹°í‹°
- ë¡œì»¬/ì†Œì…œ ê³„ì • ìƒì„± íŒ©í† ë¦¬ ë©”ì„œë“œ
- ë³´ì•ˆ ê°•í™”: ì˜¤ì§ í•´ì‹œëœ ë¹„ë°€ë²ˆí˜¸ë§Œ ì €ì¥ ğŸ”’
- ì´ë©”ì¼ ì¸ì¦ ì²˜ë¦¬
- ê³„ì • ìƒíƒœ ê´€ë¦¬ (í™œì„±í™”/ë¹„í™œì„±í™”/ì •ì§€)
- ë¡œê·¸ì¸ ì‹œê°„ ì¶”ì 
- ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ê²€ì¦

// refresh-token.entity.ts      âœ… ë¦¬í”„ë ˆì‹œ í† í° ë„ë©”ì¸ ì—”í‹°í‹°
- í† í° ë§Œë£Œ ê²€ì¦
- í† í° ì‚¬ìš© ê¸°ë¡ ê´€ë¦¬
- í† í° ê°±ì‹  ë¡œì§
- ë””ë°”ì´ìŠ¤ë³„ í† í° ê´€ë¦¬
- ë³´ì•ˆ ì¶”ì  ê¸°ëŠ¥
```

### 5. ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤ (Repository Interfaces)

```typescript
// apps/auth-vC/src/auth/domain/repository/

// user.repository.interface.ts     âœ… ì‚¬ìš©ì ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤
- CRUD ê¸°ë³¸ operations
- ì´ë©”ì¼/ì†Œì…œ ë¡œê·¸ì¸ ì¡°íšŒ
- ì¡´ì¬ ì—¬ë¶€ í™•ì¸
- í˜ì´ì§€ë„¤ì´ì…˜ ì§€ì›
- ê²€ìƒ‰ ë° í•„í„°ë§
- ìƒíƒœ ì—…ë°ì´íŠ¸ ë©”ì„œë“œ

// refresh-token.repository.interface.ts âœ… ë¦¬í”„ë ˆì‹œ í† í° ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤
- í† í° CRUD operations
- ì‚¬ìš©ìë³„ í† í° ê´€ë¦¬
- ë””ë°”ì´ìŠ¤ë³„ í† í° ì¡°íšŒ
- ë§Œë£Œëœ í† í° ì •ë¦¬
- í† í° ì‚¬ìš© ì¶”ì 
- í† í° ê°œìˆ˜ ì œí•œ ì§€ì›
```

### 6. ë„ë©”ì¸ ì„œë¹„ìŠ¤ (Domain Services)

```typescript
// apps/auth-vC/src/auth/domain/service/

// user.domain.service.ts       âœ… ì‚¬ìš©ì ë„ë©”ì¸ ì„œë¹„ìŠ¤
- ë³µì¡í•œ ì‚¬ìš©ì ìƒì„± ë¡œì§
- ì´ë©”ì¼ ì¤‘ë³µ ê²€ì‚¬ (ë¡œì»¬/ì†Œì…œ í†µí•©)
- ì‚¬ìš©ì ì¸ì¦ ë¡œì§ (ì‹¤ì œ ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ ê²€ì¦) ğŸ”’
- ê³„ì • ì—°ê²°/ë³‘í•© ë¡œì§
- ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ (í•´ì‹œ ì—…ë°ì´íŠ¸) ğŸ”’
- ê³„ì • ì‚­ì œ ì „ ê²€ì¦

// password.domain.service.ts   âœ… ë¹„ë°€ë²ˆí˜¸ ë„ë©”ì¸ ì„œë¹„ìŠ¤
- bcrypt ê¸°ë°˜ í•´ì‹± (salt + pepper)
- ë¹„ë°€ë²ˆí˜¸ ê°•ë„ í‰ê°€
- ë¹„ë°€ë²ˆí˜¸ ì •ì±… ê²€ì¦
- ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ìƒì„±
- ë¹„ë°€ë²ˆí˜¸ ë§Œë£Œ ê´€ë¦¬
- ë³€ê²½ ì£¼ê¸° ì œí•œ
```

## ğŸ“ í˜„ì¬ í´ë” êµ¬ì¡° (Step 2 ì™„ë£Œ)

```
apps/auth-vC/src/
â”œâ”€â”€ shared/                          # ê³µí†µ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ enum/                        # ì—´ê±°í˜•
â”‚   â”‚   â”œâ”€â”€ provider.enum.ts         âœ… ì¸ì¦ ì œê³µì
â”‚   â”‚   â””â”€â”€ user-status.enum.ts      âœ… ì‚¬ìš©ì ìƒíƒœ
â”‚   â””â”€â”€ type/                        # íƒ€ì… ì •ì˜
â”‚       â”œâ”€â”€ auth.type.ts            âœ… ì¸ì¦ ê´€ë ¨ íƒ€ì…
â”‚       â””â”€â”€ common.type.ts          âœ… ê³µí†µ íƒ€ì…
â”œâ”€â”€ auth/                            # Auth ë„ë©”ì¸ ë£¨íŠ¸
â”‚   â”œâ”€â”€ domain/                      # ë„ë©”ì¸ ê³„ì¸µ
â”‚   â”‚   â”œâ”€â”€ entity/                  # ë„ë©”ì¸ ì—”í‹°í‹°
â”‚   â”‚   â”‚   â”œâ”€â”€ user.entity.ts       âœ… ì‚¬ìš©ì ì—”í‹°í‹°
â”‚   â”‚   â”‚   â”œâ”€â”€ refresh-token.entity.ts âœ… ë¦¬í”„ë ˆì‹œ í† í° ì—”í‹°í‹°
â”‚   â”‚   â”‚   â””â”€â”€ index.ts             âœ… ì—”í‹°í‹° export
â”‚   â”‚   â”œâ”€â”€ vo/                      # ê°’ ê°ì²´
â”‚   â”‚   â”‚   â”œâ”€â”€ email.vo.ts          âœ… ì´ë©”ì¼ ê°’ ê°ì²´
â”‚   â”‚   â”‚   â”œâ”€â”€ password.vo.ts       âœ… ë¹„ë°€ë²ˆí˜¸ ê°’ ê°ì²´
â”‚   â”‚   â”‚   â”œâ”€â”€ provider.vo.ts       âœ… ì œê³µì ê°’ ê°ì²´
â”‚   â”‚   â”‚   â”œâ”€â”€ user-id.vo.ts        âœ… ì‚¬ìš©ì ID ê°’ ê°ì²´
â”‚   â”‚   â”‚   â””â”€â”€ index.ts             âœ… ê°’ ê°ì²´ export
â”‚   â”‚   â”œâ”€â”€ repository/              # ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ user.repository.interface.ts         âœ… ì‚¬ìš©ì ë¦¬í¬ì§€í† ë¦¬
â”‚   â”‚   â”‚   â”œâ”€â”€ refresh-token.repository.interface.ts âœ… í† í° ë¦¬í¬ì§€í† ë¦¬
â”‚   â”‚   â”‚   â””â”€â”€ index.ts             âœ… ë¦¬í¬ì§€í† ë¦¬ export
â”‚   â”‚   â”œâ”€â”€ service/                 # ë„ë©”ì¸ ì„œë¹„ìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ user.domain.service.ts      âœ… ì‚¬ìš©ì ë„ë©”ì¸ ì„œë¹„ìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ password.domain.service.ts  âœ… ë¹„ë°€ë²ˆí˜¸ ë„ë©”ì¸ ì„œë¹„ìŠ¤
â”‚   â”‚   â”‚   â””â”€â”€ index.ts             âœ… ì„œë¹„ìŠ¤ export
â”‚   â”‚   â”œâ”€â”€ exception/               # ë„ë©”ì¸ ì˜ˆì™¸
â”‚   â”‚   â”‚   â”œâ”€â”€ domain.exception.ts  âœ… ê¸°ë³¸ ë„ë©”ì¸ ì˜ˆì™¸
â”‚   â”‚   â”‚   â”œâ”€â”€ user-already-exists.exception.ts     âœ… ì‚¬ìš©ì ì¤‘ë³µ ì˜ˆì™¸
â”‚   â”‚   â”‚   â”œâ”€â”€ user-not-found.exception.ts          âœ… ì‚¬ìš©ì ë¯¸ë°œê²¬ ì˜ˆì™¸
â”‚   â”‚   â”‚   â”œâ”€â”€ invalid-credentials.exception.ts     âœ… ì˜ëª»ëœ ì¸ì¦ ì •ë³´ ì˜ˆì™¸
â”‚   â”‚   â”‚   â”œâ”€â”€ invalid-refresh-token.exception.ts   âœ… ìœ íš¨í•˜ì§€ ì•Šì€ í† í° ì˜ˆì™¸
â”‚   â”‚   â”‚   â””â”€â”€ index.ts             âœ… ì˜ˆì™¸ export
â”‚   â”‚   â””â”€â”€ index.ts                 âœ… ë„ë©”ì¸ ê³„ì¸µ ì „ì²´ export
â”‚   â””â”€â”€ infrastructure/              # ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ê³„ì¸µ (Step 1 ì™„ë£Œ)
â”‚       â””â”€â”€ database/
â”‚           â”œâ”€â”€ entity/            # TypeORM ì—”í‹°í‹°
â”‚           â””â”€â”€ migration/          # DB ë§ˆì´ê·¸ë ˆì´ì…˜
â”œâ”€â”€ config/                          # ì „ì—­ ì„¤ì • (Step 1 ì™„ë£Œ)
â””â”€â”€ app/                             # ì• í”Œë¦¬ì¼€ì´ì…˜ ë£¨íŠ¸
```

## ğŸ” ë„ë©”ì¸ ê³„ì¸µ í•µì‹¬ íŠ¹ì§•

### 1. ìˆœìˆ˜ì„± (Purity)

- ì™¸ë¶€ ì˜ì¡´ì„± ì—†ìŒ (NestJS ë°ì½”ë ˆì´í„° ì œì™¸)
- í”„ë ˆì„ì›Œí¬ ë…ë¦½ì ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- í…ŒìŠ¤íŠ¸í•˜ê¸° ì‰¬ìš´ êµ¬ì¡°

### 2. ë¶ˆë³€ì„± (Immutability)

- ê°’ ê°ì²´ëŠ” ìƒì„± í›„ ë³€ê²½ ë¶ˆê°€
- ì—”í‹°í‹° ìƒíƒœ ë³€ê²½ì€ ë©”ì„œë“œë¥¼ í†µí•´ì„œë§Œ

### 3. íƒ€ì… ì•ˆì „ì„± (Type Safety)

- ì›ì‹œ íƒ€ì… ëŒ€ì‹  ê°’ ê°ì²´ ì‚¬ìš©
- ì»´íŒŒì¼ íƒ€ì„ íƒ€ì… ê²€ì¦
- ëŸ°íƒ€ì„ ìœ íš¨ì„± ê²€ì¦

### 4. ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì¤‘ì‹¬

- ë„ë©”ì¸ ì—”í‹°í‹°ì— ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì§‘ì¤‘
- ë„ë©”ì¸ ì„œë¹„ìŠ¤ë¡œ ë³µì¡í•œ ë¡œì§ ë¶„ë¦¬
- ì˜ˆì™¸ë¥¼ í†µí•œ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ìœ„ë°˜ ì²˜ë¦¬

### 5. í™•ì¥ì„±

- ìƒˆë¡œìš´ ì¸ì¦ ì œê³µì ì‰½ê²Œ ì¶”ê°€ ê°€ëŠ¥
- ë¹„ë°€ë²ˆí˜¸ ì •ì±… í™•ì¥ ê°€ëŠ¥
- ì‚¬ìš©ì ìƒíƒœ í™•ì¥ ê°€ëŠ¥

### 6. ë³´ì•ˆì„± (Security) âœ¨

- **í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ ì™„ì „ ì œê±°**: User ì—”í‹°í‹°ì—ì„œ í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ ì €ì¥ ê¸ˆì§€
- **í•´ì‹œë§Œ ì €ì¥**: ì˜¤ì§ bcrypt í•´ì‹œëœ ë¹„ë°€ë²ˆí˜¸ë§Œ ì €ì¥
- **ë„ë©”ì¸ ì„œë¹„ìŠ¤ í†µí•œ í•´ì‹±**: í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ëŠ” ë„ë©”ì¸ ì„œë¹„ìŠ¤ì—ì„œë§Œ ì²˜ë¦¬
- **ë©”ëª¨ë¦¬ ë³´ì•ˆ**: í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ê°€ ì—”í‹°í‹°ì— ì”ì¡´í•˜ì§€ ì•ŠìŒ
- **íƒ€ì… ì•ˆì „ì„±**: Password ê°’ ê°ì²´ëŠ” ìƒì„±/ê²€ì¦ ì‹œì—ë§Œ ì‚¬ìš©

## ğŸ”’ ë³´ì•ˆ ì•„í‚¤í…ì²˜ ê°œì„ ì‚¬í•­

### Before (ë³´ì•ˆ ì·¨ì•½)

```typescript
// âŒ User ì—”í‹°í‹°ì— í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ì™€ í•´ì‹œê°€ í•¨ê»˜ ì¡´ì¬
interface UserProps {
	password?: Password; // í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ (ìœ„í—˜!)
	passwordHash?: string; // í•´ì‹œëœ ë¹„ë°€ë²ˆí˜¸
}
```

### After (ë³´ì•ˆ ê°•í™”) âœ…

```typescript
// âœ… User ì—”í‹°í‹°ì—ëŠ” ì˜¤ì§ í•´ì‹œë§Œ ì €ì¥
interface CreateUserProps {
	passwordHash?: string; // í•´ì‹œëœ ë¹„ë°€ë²ˆí˜¸ë§Œ ì €ì¥
}

// âœ… í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ëŠ” ë„ë©”ì¸ ì„œë¹„ìŠ¤ì—ì„œë§Œ ì²˜ë¦¬
class UserDomainService {
	async createLocalUser(email: Email, password: Password) {
		// 1. í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¦‰ì‹œ í•´ì‹±
		const hashedPassword = await this.hashPassword(password);

		// 2. User ì—”í‹°í‹°ì—ëŠ” í•´ì‹œë§Œ ì „ë‹¬
		const user = User.create({
			email,
			passwordHash: hashedPassword, // í•´ì‹œë§Œ ì €ì¥
		});
	}
}
```

### ë³´ì•ˆ ì¥ì 

1. **ë©”ëª¨ë¦¬ ë³´ì•ˆ**: í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ê°€ ì—”í‹°í‹°ì— ì”ì¡´í•˜ì§€ ì•ŠìŒ
2. **ì§ë ¬í™” ë³´ì•ˆ**: `toJSON()` ë“±ì—ì„œ í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ ë…¸ì¶œ ë°©ì§€
3. **ë°ì´í„°ë² ì´ìŠ¤ ë³´ì•ˆ**: DBì—ëŠ” í•´ì‹œë§Œ ì €ì¥
4. **ì½”ë“œ ì•ˆì „ì„±**: ì»´íŒŒì¼ íƒ€ì„ì— í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ ì‚¬ìš© ë°©ì§€

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„ (Step 3: ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ)

êµ¬í˜„ ì˜ˆì •:

1. **ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤**

   - `src/auth/application/service/auth.service.ts`
   - `src/auth/application/service/user.service.ts`
   - `src/auth/application/service/jwt.service.ts`

2. **ì• í”Œë¦¬ì¼€ì´ì…˜ DTO**

   - `src/auth/application/dto/auth.dto.ts`
   - `src/auth/application/dto/user.dto.ts`

3. **ë„ë©”ì¸ ì´ë²¤íŠ¸**
   - `src/auth/application/event/user-registered.event.ts`
   - `src/auth/application/event/user-logged-in.event.ts`

## ğŸ”§ í•„ìš”í•œ ì¶”ê°€ íŒ¨í‚¤ì§€

```bash
# bcrypt for password hashing
pnpm add bcrypt
pnpm add -D @types/bcrypt
```

## ğŸ§ª ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì¤€ë¹„

ë„ë©”ì¸ ê³„ì¸µì€ ì™¸ë¶€ ì˜ì¡´ì„±ì´ ì—†ì–´ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ ìš©ì´í•©ë‹ˆë‹¤:

- ê°’ ê°ì²´ í…ŒìŠ¤íŠ¸ (ìœ íš¨ì„± ê²€ì¦, ë¶ˆë³€ì„±)
- ì—”í‹°í‹° í…ŒìŠ¤íŠ¸ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)
- ë„ë©”ì¸ ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸ (ë³µì¡í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™)
- ì˜ˆì™¸ í…ŒìŠ¤íŠ¸ (ì—ëŸ¬ ì²˜ë¦¬)
